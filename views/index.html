<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

    <style>
        /* .grid-container {
            display: grid;
            grid-template-columns: auto auto;
        } */
    </style>
</head>

<body>
    <h1>Quotation Calculator</h1>
    <form class="quoatation_form">
        <div class="row g-3 align-items-center">
            <div class="col-auto">
                <label for="inputPassword6" class="col-form-label">Category Size</label>
            </div>
            <div class="col-auto">
                <select class="form-select" id="categorySize" name="sizeCategory">
                    {{ range .categorySize}}
                    <option value="{{ . }}">{{ . }}</option>
                    {{ end }}
                </select>
            </div>
            <div class="col-auto">
                <span class="form-text" id="card-dimension">
                    Must be 8-20 characters long.
                </span>
            </div>
        </div>
        <h2>Printing</h2>
        <div>
            <div class="row g-3 align-items-center">
                <div class="col-auto">
                    <label for="inputPassword6" class="col-form-label">Ready Or Custom Shape</label>
                </div>
                <div class="col-auto">
                    <select class="form-select" id="isReadiedSize" aria-label="Floating label select example">
                        <option value="readied" selected>Readied Size Shape</option>
                        <option value="custom">Custom Size Shape</option>
                    </select>
                </div>
            </div>
            <div class="row g-3 align-items-center">
                <div class="col-auto">
                    <label for="inputPassword6" class="col-form-label">Number of Colour</label>
                </div>
                <div class="col-auto">
                    <select class="form-select" id="noOfColours" aria-label="Floating label select example">
                        <option value="1">One</option>
                        <option value="2">Two</option>
                        <option value="3">Three</option>
                        <option value="3">Four</option>
                    </select>
                </div>
            </div>
            <div class="row g-3 align-items-center">
                <div class="col-auto">
                    <label for="inputPassword6" class="col-form-label">Material</label>
                </div>
                <div class="col-auto">
                    <select class="form-select" id="material" name="material">
                        <!-- <option value="art_card_350gsm" selected>Art Card 350 gsm</option> -->
                        {{ range .materials}}
                        <option value="{{ . }}">{{ . }}</option>
                        {{ end }}
                    </select>
                </div>
            </div>
            <div class="row g-3 align-items-center">
                <div class="row g-3 align-items-center col-auto">
                    <div class="col-auto">
                        <label for="inputPassword6" class="col-form-label">From Quantity</label>
                    </div>
                    <div class="col-auto">
                        <select class="form-select" id="quantityFrom" name="quantityFrom">
                            {{ range .quantityRange}}
                            <option value="{{ . }}">{{ . }}</option>
                            {{ end }}
                        </select>
                    </div>
                </div>
                <div class="row g-3 col-auto">
                    <div class="col-auto">
                        <label for="inputPassword6" class="col-form-label">To Quantity</label>
                    </div>
                    <div class="col-auto">
                        <select class="form-select" id="quantityTo" name="quantityTo">
                            {{ range .quantityRange}}
                            <option value="{{ . }}">{{ . }}</option>
                            {{ end }}
                        </select>
                    </div>
                </div>
            </div>
        </div>
        <h2>Add On</h2>
        <div>
            <div class="row g-3 align-items-center">
                <div class="col-auto">
                    <label for="inputPassword6" class="col-form-label">Surface Protection Printing</label>
                </div>
                <div class="col-auto">
                    <select class="form-select" id="surfaceProtectionPrinting"
                        aria-label="Floating label select example">
                        {{ range .surfaceProtectionPrinting}}
                        <option value="{{ . }}">{{ . }}</option>
                        {{ end }}
                    </select>
                </div>
            </div>
            <div class="row g-3 align-items-center">
                <div class="col-auto">
                    <label for="inputPassword6" class="col-form-label">Spot UV 1 Side</label>
                </div>
                <div class="col-auto">
                    <select class="form-select" id="spotUV1side" aria-label="Floating label select example">
                        <option selected value="false">Don't</option>
                        <option value="true">Yes</option>
                    </select>
                </div>
            </div>
            <div class="row g-3 align-items-center">
                <div class="col-auto">
                    <label for="inputPassword6" class="col-form-label">Window Hole Without Transperant PVC Sheet</label>
                </div>
                <div class="col-auto">
                    <select class="form-select" id="windowHoleWithoutTransparentPVCSheet"
                        aria-label="Floating label select example">
                        <option selected value="">None</option>
                        {{ range .windowHoleWithoutTransparentPVCSheet }}
                        <option value="{{ . }}">{{ . }}</option>
                        {{ end }}
                    </select>
                </div>
            </div>
            <div class="row g-3 align-items-center">
                <div class="col-auto">
                    <label for="inputPassword6" class="col-form-label">Window Hole Without Transperant PVC Sheet</label>
                </div>
                <div class="col-auto">
                    <select class="form-select" id="windowHoleWithTransparentPVCSheet"
                        aria-label="Floating label select example">
                        <option selected value="">None</option>
                        {{ range .windowHoleWithTransparentPVCSheet }}
                        <option value="{{ . }}">{{ . }}</option>
                        {{ end }}
                    </select>
                </div>
            </div>
            <div class="row g-3 align-items-center">
                <div class="col-auto">
                    <label for="inputPassword6" class="col-form-label">Hot Stamping</label>
                </div>
                <div class="col-auto">
                    <select class="form-select" id="hotstamping" aria-label="Floating label select example">
                        <option selected value="">None</option>
                        {{ range .hotstamping }}
                        <option value="{{ . }}">{{ . }}</option>
                        {{ end }}
                    </select>
                </div>
            </div>
            <div class="row g-3 align-items-center">
                <div class="col-auto">
                    <label for="inputPassword6" class="col-form-label">Emboss / Deboss</label>
                </div>
                <div class="col-auto">
                    <select class="form-select" id="embossDeboss" aria-label="Floating label select example">
                        <option selected value="">None</option>
                        {{ range .embossDeboss }}
                        <option value="{{ . }}">{{ . }}</option>
                        {{ end }}
                    </select>
                </div>
            </div>
            <div class="row g-3 align-items-center">
                <div class="col-auto">
                    <label for="inputPassword6" class="col-form-label">String</label>
                </div>
                <div class="col-auto">
                    <select class="form-select" id="stringFinishing" aria-label="Floating label select example">
                        <option selected value="">None</option>
                        {{ range .stringFinishing }}
                        <option value="{{ . }}">{{ . }}</option>
                        {{ end }}
                    </select>
                </div>
            </div>
            <div class="row g-3 align-items-center">
                <div class="col-auto">
                    <label for="inputPassword6" class="col-form-label">Print Other Side</label>
                </div>
                <div class="col-auto">
                    <select class="form-select" id="isDoubleSide" aria-label="Floating label select example">
                        <option selected value="false">No</option>
                        <option value="true">Yes</option>
                    </select>
                </div>
            </div>
            <div class="row g-3 align-items-center">
                <div class="col-auto">
                    <label for="inputPassword6" class="col-form-label">Finishing Other Side</label>
                </div>
                <div class="col-auto">
                    <select class="form-select" id="floatingSelect" aria-label="Floating label select example">
                        <option selected>Open this select menu</option>
                        <option value="1">One</option>
                        <option value="2">Two</option>
                        <option value="3">Three</option>
                    </select>
                </div>
            </div>
        </div>
        <button type="button" id="generateQuoatationBtn" class="btn btn-primary">Generate Quotation</button>
        <div class="form-floating">
            <textarea class="form-control" placeholder="Leave a comment here" style="height: 100px"
                id="quotationResult"></textarea>
            <label for="floatingTextarea2">Quotation</label>
        </div>
    </form>
    <script>
        let generateQuoatationBtn = document.getElementById('generateQuoatationBtn');
        let quotationResult = document.getElementById('quotationResult');
        let categorySize = document.getElementById('categorySize');
        let isReadiedSize = document.getElementById('isReadiedSize');
        let noOfColours = document.getElementById('noOfColours');
        let material = document.getElementById('material');
        let quantityFrom = document.getElementById('quantityFrom');
        let quantityTo = document.getElementById('quantityTo');
        let spotUV1side = document.getElementById('spotUV1side');
        let surfaceProtectionPrinting = document.getElementById('surfaceProtectionPrinting');
        let windowHoleWithoutTransparentPVCSheet = document.getElementById('windowHoleWithoutTransparentPVCSheet');
        let windowHoleWithTransparentPVCSheet = document.getElementById('windowHoleWithTransparentPVCSheet');
        let hotstamping = document.getElementById('hotstamping');
        let embossDeboss = document.getElementById('embossDeboss');
        let quantityRange = [100, 200, 300, 400, 500, 1000, 1500, 2000, 3000, 4000, 5000]

        function getQuantitySubRange(lower, upper) {
            if (lower > upper) {
                return [];
            }
            if (lower == upper) {
                return [lower];
            }
            let subRange = [];
            let semaphore = false;
            for (let i = 0; i <= quantityRange.length; i++) {
                if (quantityRange[i] == lower) {
                    subRange.push(quantityRange[i]);
                    semaphore = true;
                    continue;
                }
                if (semaphore) {
                    subRange.push(quantityRange[i]);
                    if (quantityRange[i] == upper) {
                        break;
                    }
                }
            }
            return subRange;
        }
        quantitySubRange = getQuantitySubRange(100, 500);
        generateQuoatationBtn.addEventListener('click', async function (e) {
            addOns = [];
            e.preventDefault();
            addOns.push(surfaceProtectionPrinting.value);
            if (spotUV1side.value === "true") {
                addOns.push("spot uv 1side_" + categorySize.value);
            }
            if (windowHoleWithoutTransparentPVCSheet.value !== "") {
                addOns.push("window hole without transparent pvc sheet_" + windowHoleWithoutTransparentPVCSheet.value + "_" + categorySize.value);
            }
            if (windowHoleWithTransparentPVCSheet.value !== "") {
                addOns.push("window hole with transparent pvc sheet_" + windowHoleWithTransparentPVCSheet.value);
            }
            if (hotstamping.value !== "") {
                addOns.push("hot stamping_" + hotstamping.value);
            }
            if (embossDeboss.value !== "") {
                addOns.push("emboss deboss_" + embossDeboss.value);
            }
            if (stringFinishing.value !== "") {
                addOns.push("string_" + stringFinishing.value);
            }
            const response = await fetch("/getQuotation", {
                method: "POST",
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    sizeCategory: categorySize.value,
                    readiedSize: (isReadiedSize.value === "readied") ? true : false,
                    noOfColours: parseInt(noOfColours.value),
                    material: material.value,
                    isDoubleSide: (isDoubleSide.value === "true") ? true : false,
                    addOns,
                    quantity: getQuantitySubRange(parseInt(quantityFrom.value), parseInt(quantityTo.value))
                })
            })
            const data = await response.json();
            let quotation = "" + data.priceLabel + "\n";
            data.price.forEach((element) => {
                quotation += (element + "\n");
            })
            console.log(data)
            quotationResult.value = quotation;
        });
        let quotationForm = document.querySelector('.quoatation_form');
        quotationForm.addEventListener('submit', function (e) {
            e.preventDefault();
            console.log('quotationForm');
        });
    </script>
</body>

</html>