<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

    <style>
        /* .grid-container {
            display: grid;
            grid-template-columns: auto auto;
        } */
    </style>
</head>

<body>
    <h1>Quotation Calculator</h1>
    <form class="quoatation_form">
        <div class="row g-3 align-items-center">
            <div class="col-auto">
                <label for="inputPassword6" class="col-form-label">Category Size</label>
            </div>
            <div class="col-auto">
                <select class="form-select" id="categorySize" name="sizeCategory">
                    {{ range .categorySize}}
                    <option value="{{ . }}">{{ . }}</option>
                    {{ end }}
                </select>
            </div>
            <div class="col-auto">
                <span class="form-text" id="card-dimension">
                    Printing Size
                </span>
            </div>
        </div>
        <h2>Printing</h2>
        <div>
            <div class="row g-3 align-items-center">
                <div class="col-auto">
                    <label for="inputPassword6" class="col-form-label">Ready Or Custom Shape</label>
                </div>
                <div class="col-auto">
                    <select class="form-select" id="isReadiedSize" aria-label="Floating label select example">
                        <option value="readied" selected>Readied Size Shape</option>
                        <option value="custom">Custom Size Shape</option>
                    </select>
                </div>
                <div class="col-auto">
                    <span class="form-text" id="card-dimension">
                        Readied Shape will charge lesser.
                    </span>
                </div>
            </div>
            <div class="row g-3 align-items-center">
                <div class="col-auto">
                    <label for="inputPassword6" class="col-form-label">Number of Colour</label>
                </div>
                <div class="col-auto">
                    <select class="form-select" id="noOfColours" aria-label="Floating label select example">
                        {{ range .noOfColours}}
                        <option value="{{ . }}">{{ . }}</option>
                        {{ end }}
                    </select>
                </div>
            </div>
            <div class="row g-3 align-items-center">
                <div class="col-auto">
                    <label for="inputPassword6" class="col-form-label">Material</label>
                </div>
                <div class="col-auto">
                    <select class="form-select" id="material" name="material">
                        <!-- <option value="art_card_350gsm" selected>Art Card 350 gsm</option> -->
                        {{ range .materials}}
                        <option value="{{ . }}">{{ . }}</option>
                        {{ end }}
                    </select>
                </div>
            </div>
            <div class="row g-3 align-items-center">
                <div class="row g-3 align-items-center col-auto">
                    <div class="col-auto">
                        <label for="inputPassword6" class="col-form-label">From Quantity</label>
                    </div>
                    <div class="col-auto">
                        <select class="form-select" id="quantityFrom" name="quantityFrom">
                            {{ range .quantityRange}}
                            <option value="{{ . }}">{{ . }}</option>
                            {{ end }}
                        </select>
                    </div>
                </div>
                <div class="row g-3 col-auto">
                    <div class="col-auto">
                        <label for="inputPassword6" class="col-form-label">To Quantity</label>
                    </div>
                    <div class="col-auto">
                        <select class="form-select" id="quantityTo" name="quantityTo">
                            {{ range .quantityRange}}
                            <option value="{{ . }}">{{ . }}</option>
                            {{ end }}
                        </select>
                    </div>
                </div>
            </div>
        </div>
        <h2>Primary AddOn</h2>
        <div>
            <div class="row g-3 align-items-center">
                <div class="col-auto">
                    <label for="inputPassword6" class="col-form-label">Surface Protection Finishing</label>
                </div>
                <div class="col-auto">
                    <select class="form-select" id="surfaceProtectionPrinting"
                        aria-label="Floating label select example">
                        {{ range .surfaceProtectionPrinting}}
                        <option value="{{ . }}">{{ . }}</option>
                        {{ end }}
                    </select>
                </div>
            </div>
        </div>
        <h2>Secondary AddOn</h2>
        <div>
            <div class="row g-3 align-items-center">
                <div class="col-auto">
                    <label for="inputPassword6" class="col-form-label">Spot UV 1 Side</label>
                </div>
                <div class="col-auto">
                    <select class="form-select" id="spotUV1side" aria-label="Floating label select example">
                        <option selected value="none">None</option>
                        <option value="spotUV1Side">Yes</option>
                    </select>
                </div>
            </div>
            <div class="row g-3 align-items-center">
                <div class="col-auto">
                    <label for="inputPassword6" class="col-form-label">Window Hole Without Transperant PVC Sheet</label>
                </div>
                <div class="col-auto">
                    <select class="form-select" id="windowHoleWithoutTransparentPVCSheet"
                        aria-label="Floating label select example">
                        {{ range .windowHoleWithoutTransparentPVCSheet }}
                        <option value="{{ . }}">{{ . }}</option>
                        {{ end }}
                    </select>
                </div>
            </div>
            <div class="row g-3 align-items-center">
                <div class="col-auto">
                    <label for="inputPassword6" class="col-form-label">Window hole with transparent pvc sheet</label>
                </div>
                <div class="col-auto">
                    <select class="form-select" id="windowHoleWithTransparentPVCSheet"
                        aria-label="Floating label select example">
                        {{ range .windowHoleWithTransparentPVCSheet }}
                        <option value="{{ . }}">{{ . }}</option>
                        {{ end }}
                    </select>
                </div>
            </div>
            <div class="row g-3 align-items-center">
                <div class="col-auto">
                    <label for="inputPassword6" class="col-form-label">Hot Stamping</label>
                </div>
                <div class="col-auto">
                    <select class="form-select" id="hotstamping" aria-label="Floating label select example">
                        {{ range .hotstamping }}
                        <option value="{{ . }}">{{ . }}</option>
                        {{ end }}
                    </select>
                </div>
            </div>
            <div class="row g-3 align-items-center">
                <div class="col-auto">
                    <label for="inputPassword6" class="col-form-label">Emboss / Deboss</label>
                </div>
                <div class="col-auto">
                    <select class="form-select" id="embossDeboss" aria-label="Floating label select example">
                        {{ range .embossDeboss }}
                        <option value="{{ . }}">{{ . }}</option>
                        {{ end }}
                    </select>
                </div>
            </div>
            <div class="row g-3 align-items-center">
                <div class="col-auto">
                    <label for="inputPassword6" class="col-form-label">String</label>
                </div>
                <div class="col-auto">
                    <select class="form-select" id="stringFinishing" aria-label="Floating label select example">
                        {{ range .stringFinishing }}
                        <option value="{{ . }}">{{ . }}</option>
                        {{ end }}
                    </select>
                </div>
            </div>
        </div>
        <h2>Third AddOn</h2>
        <div>
            <div class="row g-3 align-items-center">
                <div class="col-auto">
                    <label for="inputPassword6" class="col-form-label">Print Other Side</label>
                </div>
                <div class="col-auto">
                    <select class="form-select" id="isDoubleSide" aria-label="Floating label select example">
                        <option selected value="false">No</option>
                        <option value="true">Yes</option>
                    </select>
                </div>
            </div>
            <div class="row g-3 align-items-center">
                <div class="col-auto">
                    <label for="inputPassword6" class="col-form-label">Finishing Other Side</label>
                </div>
                <div class="col-auto">
                    <select class="form-select" id="finishingAnotherSide" aria-label="Floating label select example">
                        {{ range .finishingAnotherSide }}
                        <option value="{{ . }}">{{ . }}</option>
                        {{ end }}
                    </select>
                </div>
            </div>
        </div>
        <button type="button" id="generateQuoatationBtn" class="btn btn-primary">Generate Quotation</button>
        <div class="form-floating">
            <textarea class="form-control" placeholder="Leave a comment here" style="height: 100px"
                id="quotationResult"></textarea>
            <label for="floatingTextarea2">Quotation</label>
        </div>
    </form>
    <script>
        let host = `https://{{ .host }}:{{ .port }}`;
        let generateQuoatationBtn = document.getElementById('generateQuoatationBtn');
        let quotationResult = document.getElementById('quotationResult');
        // Printing
        let categorySize = document.getElementById('categorySize');
        let isReadiedSize = document.getElementById('isReadiedSize');
        let noOfColours = document.getElementById('noOfColours');
        let material = document.getElementById('material');
        let quantityFrom = document.getElementById('quantityFrom');
        let quantityTo = document.getElementById('quantityTo');
        // Primary AddOn
        let surfaceProtectionPrinting = document.getElementById('surfaceProtectionPrinting');
        // Secondary AddOn
        let spotUV1side = document.getElementById('spotUV1side');
        let windowHoleWithoutTransparentPVCSheet = document.getElementById('windowHoleWithoutTransparentPVCSheet');
        let windowHoleWithTransparentPVCSheet = document.getElementById('windowHoleWithTransparentPVCSheet');
        let hotstamping = document.getElementById('hotstamping');
        let embossDeboss = document.getElementById('embossDeboss');
        let quantityRange = [100, 200, 300, 400, 500, 1000, 1500, 2000]
        // Third AddOn
        let isDoubleSide = document.getElementById('isDoubleSide');
        let finishingAnotherSide = document.getElementById('finishingAnotherSide');

        function getQuantitySubRange(lower, upper) {
            if (lower > upper) {
                return [];
            }
            if (lower == upper) {
                return [lower];
            }
            let subRange = [];
            let semaphore = false;
            for (let i = 0; i <= quantityRange.length; i++) {
                if (quantityRange[i] == lower) {
                    subRange.push(quantityRange[i]);
                    semaphore = true;
                    continue;
                }
                if (semaphore) {
                    subRange.push(quantityRange[i]);
                    if (quantityRange[i] == upper) {
                        break;
                    }
                }
            }
            return subRange;
        }
        quantitySubRange = getQuantitySubRange(100, 500);
        generateQuoatationBtn.addEventListener('click', async function (e) {
            e.preventDefault();
            const response = await fetch(`${host}/getQuotation`, {
                method: "POST",
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    sizeCategory: categorySize.value,
                    quantity: getQuantitySubRange(parseInt(quantityFrom.value), parseInt(quantityTo.value)),
                    material: material.value,
                    noOfColours: noOfColours.value,
                    readiedSize: (isReadiedSize.value === "readied") ? true : false,
                    primaryAddOn: {
                        surfaceProtectionPrinting: surfaceProtectionPrinting.value,
                    },
                    secondaryAddOn: {
                        spotUV1side: spotUV1side.value,
                        windowHoleWithoutTransparentPVCSheet: windowHoleWithoutTransparentPVCSheet.value,
                        windowHoleWithTransparentPVCSheet: windowHoleWithTransparentPVCSheet.value,
                        hotstamping: hotstamping.value,
                        embossDeboss: embossDeboss.value,
                        string: stringFinishing.value,
                    },
                    thirdAddOn: {
                        isDoubleSide: (isDoubleSide.value === "true") ? true : false,
                        finishingAnotherSide: finishingAnotherSide.value,
                    },
                })
            })
            const responseText = await response.text();
            console.log(responseText);
            quotationResult.value = responseText;
        });
        let quotationForm = document.querySelector('.quoatation_form');
        quotationForm.addEventListener('submit', function (e) {
            e.preventDefault();
            console.log('quotationForm');
        });
    </script>
</body>

</html>